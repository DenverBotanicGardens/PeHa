---
title: "PeHa data check"
author: "Michelle DePrenger-Levin"
date: "Thursday, September 10, 2015"
output: html_document
---
```{r}
library(ggplot2)
library(reshape2)
library(grid)
```

ctrl+Alt+c will run a chunck of code

gather climate data from WWDT and/or <http://www.prism.oregonstate.edu/explorer/>  
Make sure to set the resolution to 800m and the Units to SI (metric)!!    
First 6 lines of code are metadata     
first column is YYYY-MM and then data in metric

        Latitude/Longitude      Y           X           Site
        39.6917°N, 106.9598°W   4395377.218	331953.342	Dry Lake
        39.6547°N, 106.7843°W   4390957.204	346919.7342	Above Eagle

#### Climate data
```{r}
ae_p <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/AE_precip_2015.csv"), skip=6)
dl_p <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/DL_precip_2015.csv"), skip=6)
ae_tmax <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/AE_tmax_2015.csv"), skip=6)
dl_tmax <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/DL_maxtemp_2015.csv"), skip=6)
ae_tmin <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/AE_tmin_2015.csv"), skip=6)
dl_tmin <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/DL_tmin_2015.csv"), skip=6)

ae.climate <- data.frame(ae_p,ae_tmax,ae_tmin)
ae.climate$Site <- "Above Eagle"

dl.climate <- data.frame(dl_p,dl_tmax,dl_tmin)
dl.climate$Site <- "Dry Lake"

peha.climate <- rbind(ae.climate,dl.climate)
peha.climate$Year <- substr(ae.climate$Date,1,4)
peha.climate$Month <- substr(ae.climate$Date,6,7)

head(peha.climate)
peha.c <- peha.climate[,c(1,2,4,6:9)]
names(peha.c) <- c("Date","Precip","Tmax","Tmin","Site","Year","Month")
peha.c$Date <- as.Date(paste(peha.climate$Date,"01", sep="-")) # needs the day
```


```{r}
peha_summary <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/peha_2015_summary.csv"))
```



```{r}
peha <- read.csv(path.expand("Q:/Research/All_Projects_by_Species/Penstemon SPECIES/Penstemon_harringtonii/R_code_PeHa/R_tables/peha2015.csv"))

head(peha)
```



```{r, echo=FALSE}
ggplot(peha, aes(Year, X.ofRosettes)) +
  geom_bar(stat='identity') +
  facet_grid(~Site)
```



```{r, echo=FALSE}
ggplot(peha, aes(Year, X.ofRosettes)) +
  stat_summary(fun.y = sum, geom="line") +
  facet_wrap(~Site)
```


```{r, echo=FALSE}
ggplot(peha, aes(Year, X.ofRosettes, colour = Site)) +
  stat_summary(fun.y = sum, geom="line") +
  ylab("Total Rosettes")
```


##### Summary data    
We want precipitation as the previous 12 months (July-June)
```{r}
peha_sum <- aggregate(list(TotRos = peha$X.ofRosettes), 
                      by=list(Site=peha$Site, Year=peha$Year, Transect=peha$Transect), 
                      FUN = sum)

peha_fl.herb <- aggregate(peha[,c(7,9)], 
                     by=list(Site=peha$Site, Year=peha$Year, Transect=peha$Transect),
                     FUN = function(x) sum(x)/length(x))

#Label Prev12 as 07 through 12 of the previous year and give it the year for 01-06 (of the previous year (the next year) 
peha.c$Month <- as.numeric(peha.c$Month)
peha.c$Year <- as.numeric(peha.c$Year)
peha.c$Prev12 <- peha.c$Year
peha.c[peha.c$Month > 6,8] <- peha.c[peha.c$Month > 6,6]+1


peha_c <- aggregate(peha.c[,2:4], peha.c[,c(5,8)], FUN = function(x) mean(x, na.rm = TRUE))
peha_cprecip <- aggregate(peha.c$Precip, peha.c[,c(5,8)], FUN = sum)

peha_m <- merge(peha_sum, peha_fl.herb, by = c("Site","Year","Transect"))

#in 2012 there were no rosettes found in two transects; 9 and 28
table(peha_m$Transect, peha_m$Year) 
table(peha_m$Transect, peha_m$Site) # DL transect 9 and 28
#Add zero rows for 2012 transects 9 and 28 at Dry Lake
peha_m <- rbind(peha_m, c("Dry Lake",2012,9,0,0,0), c("Dry Lake",2012,28,0,0,0))
peha_m[,c("TotRos","Fl","Br","Year")] <- lapply(peha_m[,c("TotRos","Fl","Br","Year")], as.numeric)

peha_all <- merge(peha_m, peha_c, by.x = c("Site","Year"), by.y =c("Site","Prev12"))
table(peha_all$Site,peha_all$Transect)
```


summarySE function borrowed from <http://www.cookbook-r.com/Manipulating_data/Summarizing_data/>
```{r}
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
    library(plyr)

    # New version of length which can handle NA's: if na.rm==T, don't count them
    length2 <- function (x, na.rm=FALSE) {
        if (na.rm) sum(!is.na(x))
        else       length(x)
    }

    # This does the summary. For each group's data frame, return a vector with
    # N, mean, and sd
    datac <- ddply(data, groupvars, .drop=.drop,
      .fun = function(xx, col) {
        c(N    = length2(xx[[col]], na.rm=na.rm),
          mean = mean   (xx[[col]], na.rm=na.rm),
          sd   = sd     (xx[[col]], na.rm=na.rm)
        )
      },
      measurevar
    )

    # Rename the "mean" column    
    datac <- rename(datac, c("mean" = measurevar))

    datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean

    # Confidence interval multiplier for standard error
    # Calculate t-statistic for confidence interval: 
    # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
    ciMult <- qt(conf.interval/2 + .5, datac$N-1)
    datac$ci <- datac$se * ciMult

    return(datac)
}
```


Add summary statistics to the peha table
```{r}
peha_sumSE <- summarySE(peha_all, measurevar="TotRos", groupvars=c("Site","Year"))
peha_sumSEfl <- summarySE(peha_all, measurevar="Fl", groupvars=c("Site","Year"))
peha_sumSEbr <- summarySE(peha_all, measurevar="Br", groupvars=c("Site","Year"))
peha_sumSEprecip <- summarySE(peha.c, measurevar="Precip", groupvars=c("Site","Prev12"))
```

Add "a)" to each plot     

Figure 1a) average rosettes per transect
```{r}
ggplot(peha_sumSE, aes(Year, TotRos, colour=Site)) +
  geom_point(position=position_dodge(0.1), shape=21, fill="white") +
  stat_summary(fun.y = function(x) mean(x, na.rm = TRUE), geom="line") +
  geom_errorbar(aes(ymin=TotRos-se, ymax=TotRos+se),width=1, position = position_dodge(0.1)) +
  theme_bw() +
  ylab("Average rosettes per transect") +
  theme(legend.justification=c(1,1), legend.position=c(1,1)) +
  ggtitle("a)") +
  theme(plot.title=element_text(hjust=0))
```


Figure 1b) percent of indivdiuals that are flowering or fruiting
```{r}
ggplot(peha_sumSEfl, aes(Year, Fl, colour=Site)) +
  geom_point(position=position_dodge(0.1), shape=21, fill="white") +
  stat_summary(fun.y = function(x) mean(x, na.rm = TRUE), geom="line") +
  geom_errorbar(aes(ymin=Fl-se, ymax=Fl+se),width=1, position = position_dodge(0.1)) +
  theme_bw() +
  ylab("% of reproductive individuals") +
  theme(legend.justification=c(1,1), legend.position=c(1,1))+
  ggtitle("b)") +
  theme(plot.title=element_text(hjust=0))
```


Figure 1c) percent of indivdiuals with herbivory
```{r}
ggplot(peha_sumSEbr, aes(Year, Br, colour=Site)) +
  geom_point(position=position_dodge(0.1), shape=21, fill="white") +
  stat_summary(fun.y = function(x) mean(x, na.rm = TRUE), geom="line") +
  geom_errorbar(aes(ymin=Br-se, ymax=Br+se),width=1, position = position_dodge(0.1)) +
  theme_bw() +
  ylab("% of individuals with herbivory") +
  theme(legend.justification=c(1,0), legend.position=c(1,0)) +
  ggtitle("c)") +
  theme(plot.title=element_text(hjust=0))
```


Average precipitation by month
```{r}
ggplot(peha_sumSEprecip, aes(Prev12, Precip, colour=Site)) +
  geom_point(position=position_dodge(0.2), shape=21, fill="white") +
  stat_summary(fun.y = function(x) mean(x, na.rm = TRUE), geom="line") +
  geom_errorbar(aes(ymin=Precip-se, ymax=Precip+se),width=1, position = position_dodge(0.2)) +
  theme_bw() +
  ylab("Average monthly precipition (cm)") +
  theme(legend.justification=c(0,1), legend.position=c(0,1))
```


Figure 1d) annual precipitation (mm) from the previous 12 months (July-June).
```{r}
ggplot(subset(peha_cprecip, Prev12 < 2016), aes(Prev12, x, colour=Site)) +
  geom_point(position=position_dodge(0.2), shape=21, fill="white") +
  stat_summary(fun.y = function(x) mean(x, na.rm = TRUE), geom="line") +
  theme_bw() +
  ylab("Total 12 month precipition (mm)") +
  theme(legend.justification=c(0,0), legend.position=c(0,0))  +
  ggtitle("d)") +
  theme(plot.title=element_text(hjust=0))

```


Seaonal climate means     
fall- July:Sept (7-9)     
winter- Oct:Dec (10-12)    
spring- Jan:March (1-3)    
summer- April:June (4-6)     
```{r}
peha.c$season <- "fall" 
peha.c[peha.c$Month>9 & peha.c$Month<13,"season"] <- "winter" 
peha.c[peha.c$Month>0 & peha.c$Month<4,"season"] <- "spring" 
peha.c[peha.c$Month>3 & peha.c$Month<7,"season"] <- "summer" 

peha.c.summary <- aggregate(peha.c[,2:4], peha.c[,c("Site","Prev12","season")], 
                            FUN = function(x) mean(x, na.rm = TRUE))

```



Merge summary data with precipition data
```{r}
peha.1 <- merge(peha_all, peha.c.summary, by.x=c("Site","Year"), by.y=c("Site","Prev12"))
```



Need to fix CountPVA to spit out one data.frame and necessitate assigning it to something   
<http://www.montana.edu/screel/Webpages/conservation%20biology/BIOL%20521%20count%20based%20PVA%20grizzly%20data.R>    

CountPVA produces a list of two data frames, PVA and LM. PVA has the annual log growth rates and LM has the results of the linear model from Morris and Doak Population Viability Analysis
```{r}
load(path.expand("Q:/Research/Stats & Software/R CODE/Functions/CountPVAFunction.R"))
```

```{r}
peha_count <- aggregate(list(TotRos = peha$X.ofRosettes), 
                      by=list(Site=peha$Site, Year=peha$Year), 
                      FUN = sum)

DL.list <- CountPVA(peha_count[peha_count$Site=="Dry Lake","Year"],
         peha_count[peha_count$Site=="Dry Lake","TotRos"])

AE.list <- CountPVA(peha_count[peha_count$Site=="Above Eagle","Year"],
         peha_count[peha_count$Site=="Above Eagle","TotRos"])
```


Using these count estimates, the population growth rate (λ) at Above Eagle is 0.99 (95% CI: 0.94-1.04) and at Dry Lake is 0.98 (95% CI: 0.84-1.14).     
```{r}
lambda.DL <- DL.list[[2]][nrow(DL.list[[2]]),]
lambda.AE <- AE.list[[2]][nrow(AE.list[[2]]),]
lamDL <- lapply(lambda.DL[,4:6], function(x) exp(x))
lamAE <- lapply(lambda.AE[,4:6], function(x) exp(x))
```

Figure 2. Annual growth rate estimates with 95% confidence intervals for consectutive additional years of demogrphaic study    
```{r}
ggplot(AE.list[["LM"]], aes(RangeEnd,exp(fit))) +
  geom_point() +
  stat_smooth() +
  xlab("Data calculated 1996 - Year") +
  ylab("Estimated growth rate") +
  theme_bw() +
  theme(legend.position="none") +
  geom_line(aes(RangeEnd,exp(lwr), colour = "red")) +
  geom_line(aes(RangeEnd,exp(upr),colour = "red")) +
  ggtitle("Above Eagle") +
  geom_hline(aes(yintercept=1), colour = "darkgreen")

ggplot(DL.list[["LM"]], aes(RangeEnd,exp(fit))) +
  geom_point() +
  stat_smooth() +
  xlab("Data calculated 1996 - Year") +
  ylab("Estimated growth rate") +
  theme_bw() +
  theme(legend.position="none") +
  geom_line(aes(RangeEnd,exp(lwr), colour = "red")) +
  geom_line(aes(RangeEnd,exp(upr),colour = "red"))+
  ggtitle("Dry Lake") +
  geom_hline(aes(yintercept=1), colour = "darkgreen")

```


Need the total precipitation for the previous 12 months (July-June) merged to peha_all. x is sum of precip last 12 months
```{r}
peha_all_sum <- merge(peha_all, peha_cprecip, by.y = c("Site","Prev12"), by.x = c("Site","Year"))
```

Figure 3. Annual precipitation by (A) number of individuals, (B) percent reproductive and (c) percent herbivory. Black=Above Eagle, Red=Dry Lake
```{r}
ggplot(peha_all_sum, aes(x, TotRos, colour = Site)) +
  geom_point() +
  geom_smooth(method ="lm") +
  scale_color_manual(values = c("black","red")) +
  theme_bw() +
  xlab("") +
  ylab(expression(paste("Average rosettes per 60m"^2))) +
  theme(legend.justification=c(0,1), legend.position=c(0,1))+
  ggtitle("a)") +
  theme(plot.title=element_text(hjust=0))
```

```{r}
ggplot(peha_all_sum, aes(x, Fl, colour = Site)) +
  geom_point() +
  geom_smooth(method ="lm") +
  scale_color_manual(values = c("black","red")) +
  theme_bw() +
  xlab("") +
  ylab("% reproductive individuals") +
  theme(legend.justification=c(0,1), legend.position=c(0,1))+
  ggtitle("b)") +
  theme(plot.title=element_text(hjust=0))
```

```{r}
ggplot(peha_all_sum, aes(x, Br, colour = Site)) +
  geom_point() +
  geom_smooth(method ="lm") +
  scale_color_manual(values = c("black","red")) +
  theme_bw() +
  xlab("Annual precipitation (mm)") +
  ylab("% of individuals with herbivory") +
  theme(legend.justification=c(0,0), legend.position=c(0,0))+
  ggtitle("c)") +
  theme(plot.title=element_text(hjust=0))
```
 
 
"To adhere to the sum-to-zero convention for effect weights" suggests running the following code before running anovas in R   
Sure seems to be missing something..
```{r}
#options(contrasts(c("contr.sum","contr.poly")))
```

<https://gribblelab.wordpress.com/2009/03/09/repeated-measures-anova-using-r/>      
ANOVA for by factors Site and Year:     
rosettes per transect log transformed     
% reproductive (arcsin squareroot transformed)       
% herbivory (arcsin squareroot transformed)      
<http://yatani.jp/teaching/doku.php?id=hcistats:anova#how_to_report_the_results_of_one-way_anova>       
check for sphericity with a mauchly.test
```{r}
#Matrix with rows as within-subject factors (subject) and columns are the groups to compare (Year and Site or maybe just Year?)
data <- reshape(peha_all_sum[,c(1:4)], 
             idvar = c("Site","Transect"), 
             timevar = "Year", 
             v.names = c("TotRos"), direction = "wide")

#Build multivariate linear model with matrix
model <- lm(as.matrix(data[,-(1:2)])~1)

#define design by list of independent variables
design <- factor(unique(peha_all_sum$Year))

library(car)

options(contrasts = c("contr.sum","contr.poly"))
aov <- Anova(model, idata=data.frame(design), idesign=~design, type="III")
summary(aov, multivariate=FALSE)

#Departure from the sphericity. Epsilon (0-1) Generally use Greenhouse-Geisse unless it's greater than 0.75. Then multiply the degree of freedom by epsilon 
#You can make a correction by multiplying the degree of freedom by the epsilon. Let's assume that we need to make a correction. The degree of freedom of design is 2. The epsilon of Greenhouse-Geisser is 0.734. Thus, the new degree of freedom after the correction is 1.468. You also do the same thing for the second degree of freedom (i.e., 14 * 0.734 = 10.276). So now you say you have F(1.47, 10.28)=10.92 instead of F(2, 14)=10.92. The p value with the adjusted F value is available right next to the epsilon. In this example, the p value is 0.00452, and you have a significant effect. You don't have to do anything for the effect size.

#NEED TO DO SOMETHING TO ACCOUNT FOR departure from sphericity
```


```{r}
par(mfrow = c(1,2))
hist(peha_all_sum$TotRos)
hist(log(peha_all_sum$TotRos+1))

hist(peha_all_sum$Fl)
hist(asin(sqrt(peha_all_sum$Fl)))

hist(peha_all_sum$Br)
hist(asin(sqrt(peha_all_sum$Br)))

# add a subject unique identifier row
peha_all_sum$subject <- paste(substr(peha_all_sum$Site,1,1),
                              substr(peha_all_sum$Year,3,4),
                              peha_all_sum$Transect, sep=".")

# still missing the elipse-something corrections
peha.aov.ros <- aov(log(TotRos+1)~Year*Site + 
                      Error(subject/(Year*Site)), 
                    data = peha_all_sum)
summary(peha.aov.ros)

peha.aov.ros1 <- aov(log(TotRos+1)~Year*Site + Error(subject), data=peha_all_sum) 
summary(peha.aov.ros1) 
```

Above Eagle is significantly decreasing while Dry Lake is stable - looks like no, they are both signficantly decreasing?
```{r}
summary(lm(log(TotRos+1)~Year*Site, data=peha_all_sum))

ggplot(peha_all_sum, aes( Year, log(TotRos+1), colour = Site)) +
  geom_point() +
  geom_smooth(method="lm") +
  ylab(expression(paste("log transformed Average rosettes per 60m"^2)))

ggplot(peha_all_sum, aes(Year, TotRos, colour = Site)) +
  geom_point() +
  geom_smooth(method="lm") +
  ylab(expression(paste("Average rosettes per 60m"^2)))

```

There is a signficantly greater proportion of reproductive individuals found at Above Eagle than at Dry Lake 
```{r}
peha.aov.fl <-aov(asin(sqrt(Fl))~Year*Site + Error(subject), data=peha_all_sum) 
summary(peha.aov.fl) 

ggplot(peha_all_sum, aes(Year, asin(sqrt(Fl)), colour = Site)) +
  geom_point() +
  geom_smooth(method="lm") +
  ylab("Average percent of reproductive individuals (arcsine transformed)")

ggplot(peha_all_sum, aes(Year, Fl, colour = Site)) +
  geom_point() +
  geom_smooth(method="lm") +
  ylab("Average percent of reproductive individuals")
```

Significantly more browsing at Dry Lake
```{r}
peha.aov.Br <-aov(asin(sqrt(Br))~Year*Site + Error(subject), data=peha_all_sum) 
summary(peha.aov.Br) 

ggplot(peha_all_sum, aes(Year, asin(sqrt(Br)), colour = Site)) +
  geom_point() +
  geom_smooth(method="lm") +
  ylab("Average percent of browsed individuals (arcsine transformed")

ggplot(peha_all_sum, aes(Year, Br, colour = Site)) +
  geom_point() +
  geom_smooth(method="lm") +
  ylab("Average percent of browsed individuals")
```


## Total rosettes
Rosettes fluctuated over time
```{r}
peha_totros <- aggregate(list(TotRos = peha$X.ofRosettes), 
                      by=list(Site=peha$Site, Year=peha$Year), 
                      FUN = sum)


max <- aggregate(TotRos ~ Site, peha_totros, FUN = function(x) max(x))
merge(max,peha_totros)

min <- aggregate(TotRos ~ Site, peha_totros, function(x) min(x))
merge(min,peha_totros)

peha_sumSE[which.max(peha_sumSE$TotRos),]
peha_sumSE[which.min(peha_sumSE$TotRos),]

#Average rosettes
lapply(split(peha_sumSE, peha_sumSE$Site), function(x) {
  rbind(max = x[which.max(x$TotRos),],min = x[which.min(x$TotRos),])
})

```



#Percent Herbivory - t.tests
T-test between years of browsing
```{r}
dl <- subset(peha_all_sum, Site == "Dry Lake")
ae <- subset(peha_all_sum, Site == "Above Eagle")
yrs <- unique(peha_all_sum$Year)
#Dry Lake
t.listdl <- vector("list", length(yrs)-1)
names(t.listdl) <- c(paste(yrs[-length(yrs)],yrs[-1], sep = "."))
for(yr in 1:(length(yrs)-1)){
  t.listdl[[yr]] <- t.test(Br~Year, 
                        data = subset(dl, Year == yrs[yr] | Year == yrs[yr+1]), paired = TRUE)
}

t.listdl
results.dl <- data.frame(sapply(t.listdl, "[", c("p.value","statistic","parameter")))
names(results.dl) <- c(paste(yrs[-length(yrs)],yrs[-1], sep = "."))
results.dl

#Above Eagle
t.listae <- vector("list", length(yrs)-1)
for(yr in 1:(length(yrs)-1)){
  t.listae[[yr]] <- t.test(Br~Year, 
                        data = subset(ae, Year == yrs[yr] | Year == yrs[yr+1]), paired = TRUE)
}

t.listae
results.ae <- data.frame(sapply(t.listae, "[", c("p.value","statistic","parameter")))
names(results.ae) <- c(paste(yrs[-length(yrs)],yrs[-1], sep = "."))
results.ae
```



#Average number of rosettes - t.tests
T-test between years for number of rosettes
In some years there were no rosettes in 
```{r}

dl <- subset(peha_all_sum, Site == "Dry Lake")
ae <- subset(peha_all_sum, Site == "Above Eagle")
yrs <- unique(peha_all_sum$Year)
#Dry Lake
t.listdl <- vector("list", length(yrs)-1)
names(t.listdl) <- c(paste(yrs[-length(yrs)],yrs[-1], sep = "."))
for(yr in 1:(length(yrs)-1)){
  t.listdl[[yr]] <- t.test(TotRos~Year, 
                        data = subset(dl, Year == yrs[yr] | Year == yrs[yr+1]), 
                        paired = TRUE)
}

t.listdl
results.dl <- data.frame(sapply(t.listdl, "[", c("p.value","statistic","estimate","parameter")))
names(results.dl) <- c(paste(yrs[-length(yrs)],yrs[-1], sep = "."))
results.dl

#Above Eagle
t.listae <- vector("list", length(yrs)-1)
names(t.listae) <- c(paste(yrs[-length(yrs)],yrs[-1], sep = "."))
for(yr in 1:(length(yrs)-1)){
  t.listae[[yr]] <- t.test(TotRos~Year, 
                        data = subset(ae, Year == yrs[yr] | Year == yrs[yr+1]), paired = TRUE)
}

t.listae
results.ae <- data.frame(sapply(t.listae, "[", c("p.value","statistic","estimate","parameter")))
names(results.ae) <- c(paste(yrs[-length(yrs)],yrs[-1], sep = "."))
results.ae
```

ANOVA and lm of precipitation
```{r}
peha.climate.aov <- aov(Precip~Prev12*Site, data = subset(peha.c, Prev12 < 2016))
summary(peha.climate.aov)
```



ANOVA and lm of total rosettes and precipitation
```{r}
summary(lm(log(TotRos+1)~Precip*Site,data = peha_all_sum))

# Dry Lake only
summary(lm(log(TotRos+1)~Precip,data = subset(peha_all_sum, Site == "Dry Lake")))


# Above Eagle only
summary(lm(log(TotRos+1)~Precip,data = subset(peha_all_sum, Site == "Above Eagle")))
```

ANOVA and lm of percent reproductive and precipitation
```{r}
summary(lm(asin(sqrt(Fl))~Precip*Site,data = peha_all_sum))

# Dry Lake only
summary(lm(asin(sqrt(Fl))~Precip,data = subset(peha_all_sum, Site == "Dry Lake")))


# Above Eagle only
summary(lm(asin(sqrt(Fl))~Precip,data = subset(peha_all_sum, Site == "Above Eagle")))
```


ANOVA and lm of percent browsing and precipitation
```{r}
summary(lm(asin(sqrt(Br))~Precip*Site,data = peha_all_sum))

# Dry Lake only
summary(lm(asin(sqrt(Br))~Precip,data = subset(peha_all_sum, Site == "Dry Lake")))


# Above Eagle only
summary(lm(asin(sqrt(Br))~Precip,data = subset(peha_all_sum, Site == "Above Eagle")))
```

